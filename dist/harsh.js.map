{"version":3,"sources":["node_modules/browser-pack/_prelude.js","index.js"],"names":[],"mappings":"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","file":"harsh.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict'\n\nconst createSalts = (n, base) => {\n  let salts = []\n  for (let i = 0; i < n; i++) {\n    salts.push(Math.floor(Math.random() * Math.pow(10, 6)).toString(base))\n  }\n  return salts\n}\n\nconst createHash = (id, salts, base) => {\n  const hash = id.toString(base)\n  let pieces = [...salts, hash]\n  let hashString = ''\n  do {\n    let index = Math.floor(Math.random() * pieces.length)\n    hashString += pieces[index]\n    pieces.splice(index, 1)\n  } while (pieces.length)\n  return hashString\n}\n\nmodule.exports = {\n  /**\n   * Takes a number and a radix base, outputs a salted hash\n   * @param  {Array} ids   list of ids to hash\n   * @param {Number} n number of salts to add to the hash\n   * @param  {Number} base radix base, 16 through 36 allowed\n   * @return {Object}      a hash object containing the hashes as well as info needed to reverse them\n   */\n  hash (ids, n, base) {\n    ids = ids || [Math.floor(Math.random() * 100)]\n    n = n || 2\n    base = base || 36\n\n    if (!ids.splice) {\n      throw new TypeError('The ids argument should be an array of numbers')\n    }\n    if (typeof n !== 'number' || n < 0) {\n      throw new TypeError('The number of salts should be a positive integer')\n    }\n    if (typeof base !== 'number' || base < 16 || base > 36) {\n      throw new TypeError('The base should be a number between 16 and 36')\n    }\n\n    // Create the salts. This will be the same for all hashes\n    const salts = createSalts(n, base)\n\n    // Combine the salts and the actual\n    let hashes = ids.map((id) => {\n      if (typeof id !== 'number') {\n        throw new TypeError('The ids you\\'re hashing should only be numbers')\n      }\n      return createHash(id, salts, base)\n    })\n\n    return {\n      ids: ids,\n      hashes: hashes,\n      salts: salts,\n      base: base\n    }\n  },\n  /**\n   * Simplified API to just return a single token using defaults\n   * @return {String} a hash\n   */\n  hashish () {\n    return createHash(\n      [Math.floor(Math.random() * 100)],\n      createSalts(2, 36),\n      36\n    )\n  },\n  /**\n   * Creates a specified number of random tokens\n   * @param  {Number} num  number of tokens to create\n   * @param  {Number} n    number of salts to add to each hash\n   * @param  {Number} base radix base, 16 through 36 allowed\n   * @return {Object}      a hash object containing the hashes as well as info needed to reverse them\n   */\n  bunch (num, n, base) {\n    num = num || 1\n    n = n || 2\n    base = base || 36\n\n    if (typeof num !== 'number') {\n      throw new TypeError('The num should be a number')\n    }\n    if (typeof n !== 'number' || n < 0) {\n      throw new TypeError('The number of salts should be a positive integer')\n    }\n    if (typeof base !== 'number' || base < 16 || base > 36) {\n      throw new TypeError('The base should be a number between 16 and 36')\n    }\n\n    // Create the ids\n    let ids = []\n    for (let i = 0; i < num; i++) {\n      ids.push(Math.floor(Math.random() * Math.pow(10, num.toString(10).length + 2)))\n    }\n\n    // Create the salts. This will be the same for all hashes\n    const salts = createSalts(n, base)\n\n    // Combine the salts and the actual\n    let hashes = ids.map((id) => {\n      return createHash(id, salts, base)\n    })\n\n    return {\n      ids: ids,\n      hashes: hashes,\n      salts: salts,\n      base: base\n    }\n  },\n  /**\n   * Takes a string and necessary components to reverse back to the original number\n   * @param  {Array} hashes   list of hashes to reverse\n   * @param  {Array} salts  list of salts applied to the list (provided from `hash`)\n   * @param  {base} base     radix base, 16 through 36 allowed\n   * @return {Array}          list of reversed hashes\n   */\n  reverse (hashes, salts, base) {\n    base = base || 36\n\n    if (!hashes.splice) {\n      throw new TypeError('The hashes argument should be an array of hashes provided by the hash method')\n    }\n    if (!salts.splice) {\n      throw new TypeError('The salts argument should be an array of salt strings provided by the hash method')\n    }\n    if (typeof base !== 'number' || base < 16 || base > 36) {\n      throw new TypeError('The base should be a number between 16 and 36')\n    }\n    const re = new RegExp(salts.join('|'), 'g')\n\n    let reversed = hashes.map((hash) => {\n      if (typeof hash !== 'string') {\n        throw new TypeError('The hashes you\\'re reversing should only be strings')\n      }\n      let stripped = hash.replace(re, '')\n      return parseInt(stripped, base)\n    })\n\n    return reversed\n  }\n}\n"],"preExisting":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOzs7O0FBRUEsSUFBTSxjQUFjLFNBQWQsV0FBYyxDQUFDLENBQUQsRUFBSSxJQUFKLEVBQWE7QUFDL0IsTUFBSSxRQUFRLEVBQVo7QUFDQSxPQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksQ0FBcEIsRUFBdUIsR0FBdkIsRUFBNEI7QUFDMUIsVUFBTSxJQUFOLENBQVcsS0FBSyxLQUFMLENBQVcsS0FBSyxNQUFMLEtBQWdCLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxDQUFiLENBQTNCLEVBQTRDLFFBQTVDLENBQXFELElBQXJELENBQVg7QUFDRDtBQUNELFNBQU8sS0FBUDtBQUNELENBTkQ7O0FBUUEsSUFBTSxhQUFhLFNBQWIsVUFBYSxDQUFDLEVBQUQsRUFBSyxLQUFMLEVBQVksSUFBWixFQUFxQjtBQUN0QyxNQUFNLE9BQU8sR0FBRyxRQUFILENBQVksSUFBWixDQUFiO0FBQ0EsTUFBSSxzQ0FBYSxLQUFiLElBQW9CLElBQXBCLEVBQUo7QUFDQSxNQUFJLGFBQWEsRUFBakI7QUFDQSxLQUFHO0FBQ0QsUUFBSSxRQUFRLEtBQUssS0FBTCxDQUFXLEtBQUssTUFBTCxLQUFnQixPQUFPLE1BQWxDLENBQVo7QUFDQSxrQkFBYyxPQUFPLEtBQVAsQ0FBZDtBQUNBLFdBQU8sTUFBUCxDQUFjLEtBQWQsRUFBcUIsQ0FBckI7QUFDRCxHQUpELFFBSVMsT0FBTyxNQUpoQjtBQUtBLFNBQU8sVUFBUDtBQUNELENBVkQ7O0FBWUEsT0FBTyxPQUFQLEdBQWlCO0FBQ2Y7Ozs7Ozs7QUFPQSxNQVJlLGdCQVFULEdBUlMsRUFRSixDQVJJLEVBUUQsSUFSQyxFQVFLO0FBQ2xCLFVBQU0sT0FBTyxDQUFDLEtBQUssS0FBTCxDQUFXLEtBQUssTUFBTCxLQUFnQixHQUEzQixDQUFELENBQWI7QUFDQSxRQUFJLEtBQUssQ0FBVDtBQUNBLFdBQU8sUUFBUSxFQUFmOztBQUVBLFFBQUksQ0FBQyxJQUFJLE1BQVQsRUFBaUI7QUFDZixZQUFNLElBQUksU0FBSixDQUFjLGdEQUFkLENBQU47QUFDRDtBQUNELFFBQUksT0FBTyxDQUFQLEtBQWEsUUFBYixJQUF5QixJQUFJLENBQWpDLEVBQW9DO0FBQ2xDLFlBQU0sSUFBSSxTQUFKLENBQWMsa0RBQWQsQ0FBTjtBQUNEO0FBQ0QsUUFBSSxPQUFPLElBQVAsS0FBZ0IsUUFBaEIsSUFBNEIsT0FBTyxFQUFuQyxJQUF5QyxPQUFPLEVBQXBELEVBQXdEO0FBQ3RELFlBQU0sSUFBSSxTQUFKLENBQWMsK0NBQWQsQ0FBTjtBQUNEOztBQUVEO0FBQ0EsUUFBTSxRQUFRLFlBQVksQ0FBWixFQUFlLElBQWYsQ0FBZDs7QUFFQTtBQUNBLFFBQUksU0FBUyxJQUFJLEdBQUosQ0FBUSxVQUFDLEVBQUQsRUFBUTtBQUMzQixVQUFJLE9BQU8sRUFBUCxLQUFjLFFBQWxCLEVBQTRCO0FBQzFCLGNBQU0sSUFBSSxTQUFKLENBQWMsZ0RBQWQsQ0FBTjtBQUNEO0FBQ0QsYUFBTyxXQUFXLEVBQVgsRUFBZSxLQUFmLEVBQXNCLElBQXRCLENBQVA7QUFDRCxLQUxZLENBQWI7O0FBT0EsV0FBTztBQUNMLFdBQUssR0FEQTtBQUVMLGNBQVEsTUFGSDtBQUdMLGFBQU8sS0FIRjtBQUlMLFlBQU07QUFKRCxLQUFQO0FBTUQsR0F4Q2M7O0FBeUNmOzs7O0FBSUEsU0E3Q2UscUJBNkNKO0FBQ1QsV0FBTyxXQUNMLENBQUMsS0FBSyxLQUFMLENBQVcsS0FBSyxNQUFMLEtBQWdCLEdBQTNCLENBQUQsQ0FESyxFQUVMLFlBQVksQ0FBWixFQUFlLEVBQWYsQ0FGSyxFQUdMLEVBSEssQ0FBUDtBQUtELEdBbkRjOztBQW9EZjs7Ozs7OztBQU9BLE9BM0RlLGlCQTJEUixHQTNEUSxFQTJESCxDQTNERyxFQTJEQSxJQTNEQSxFQTJETTtBQUNuQixVQUFNLE9BQU8sQ0FBYjtBQUNBLFFBQUksS0FBSyxDQUFUO0FBQ0EsV0FBTyxRQUFRLEVBQWY7O0FBRUEsUUFBSSxPQUFPLEdBQVAsS0FBZSxRQUFuQixFQUE2QjtBQUMzQixZQUFNLElBQUksU0FBSixDQUFjLDRCQUFkLENBQU47QUFDRDtBQUNELFFBQUksT0FBTyxDQUFQLEtBQWEsUUFBYixJQUF5QixJQUFJLENBQWpDLEVBQW9DO0FBQ2xDLFlBQU0sSUFBSSxTQUFKLENBQWMsa0RBQWQsQ0FBTjtBQUNEO0FBQ0QsUUFBSSxPQUFPLElBQVAsS0FBZ0IsUUFBaEIsSUFBNEIsT0FBTyxFQUFuQyxJQUF5QyxPQUFPLEVBQXBELEVBQXdEO0FBQ3RELFlBQU0sSUFBSSxTQUFKLENBQWMsK0NBQWQsQ0FBTjtBQUNEOztBQUVEO0FBQ0EsUUFBSSxNQUFNLEVBQVY7QUFDQSxTQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksR0FBcEIsRUFBeUIsR0FBekIsRUFBOEI7QUFDNUIsVUFBSSxJQUFKLENBQVMsS0FBSyxLQUFMLENBQVcsS0FBSyxNQUFMLEtBQWdCLEtBQUssR0FBTCxDQUFTLEVBQVQsRUFBYSxJQUFJLFFBQUosQ0FBYSxFQUFiLEVBQWlCLE1BQWpCLEdBQTBCLENBQXZDLENBQTNCLENBQVQ7QUFDRDs7QUFFRDtBQUNBLFFBQU0sUUFBUSxZQUFZLENBQVosRUFBZSxJQUFmLENBQWQ7O0FBRUE7QUFDQSxRQUFJLFNBQVMsSUFBSSxHQUFKLENBQVEsVUFBQyxFQUFELEVBQVE7QUFDM0IsYUFBTyxXQUFXLEVBQVgsRUFBZSxLQUFmLEVBQXNCLElBQXRCLENBQVA7QUFDRCxLQUZZLENBQWI7O0FBSUEsV0FBTztBQUNMLFdBQUssR0FEQTtBQUVMLGNBQVEsTUFGSDtBQUdMLGFBQU8sS0FIRjtBQUlMLFlBQU07QUFKRCxLQUFQO0FBTUQsR0E5RmM7O0FBK0ZmOzs7Ozs7O0FBT0EsU0F0R2UsbUJBc0dOLE1BdEdNLEVBc0dFLEtBdEdGLEVBc0dTLElBdEdULEVBc0dlO0FBQzVCLFdBQU8sUUFBUSxFQUFmOztBQUVBLFFBQUksQ0FBQyxPQUFPLE1BQVosRUFBb0I7QUFDbEIsWUFBTSxJQUFJLFNBQUosQ0FBYyw4RUFBZCxDQUFOO0FBQ0Q7QUFDRCxRQUFJLENBQUMsTUFBTSxNQUFYLEVBQW1CO0FBQ2pCLFlBQU0sSUFBSSxTQUFKLENBQWMsbUZBQWQsQ0FBTjtBQUNEO0FBQ0QsUUFBSSxPQUFPLElBQVAsS0FBZ0IsUUFBaEIsSUFBNEIsT0FBTyxFQUFuQyxJQUF5QyxPQUFPLEVBQXBELEVBQXdEO0FBQ3RELFlBQU0sSUFBSSxTQUFKLENBQWMsK0NBQWQsQ0FBTjtBQUNEO0FBQ0QsUUFBTSxLQUFLLElBQUksTUFBSixDQUFXLE1BQU0sSUFBTixDQUFXLEdBQVgsQ0FBWCxFQUE0QixHQUE1QixDQUFYOztBQUVBLFFBQUksV0FBVyxPQUFPLEdBQVAsQ0FBVyxVQUFDLElBQUQsRUFBVTtBQUNsQyxVQUFJLE9BQU8sSUFBUCxLQUFnQixRQUFwQixFQUE4QjtBQUM1QixjQUFNLElBQUksU0FBSixDQUFjLHFEQUFkLENBQU47QUFDRDtBQUNELFVBQUksV0FBVyxLQUFLLE9BQUwsQ0FBYSxFQUFiLEVBQWlCLEVBQWpCLENBQWY7QUFDQSxhQUFPLFNBQVMsUUFBVCxFQUFtQixJQUFuQixDQUFQO0FBQ0QsS0FOYyxDQUFmOztBQVFBLFdBQU8sUUFBUDtBQUNEO0FBN0hjLENBQWpCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0J1xuXG5jb25zdCBjcmVhdGVTYWx0cyA9IChuLCBiYXNlKSA9PiB7XG4gIGxldCBzYWx0cyA9IFtdXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgc2FsdHMucHVzaChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBNYXRoLnBvdygxMCwgNikpLnRvU3RyaW5nKGJhc2UpKVxuICB9XG4gIHJldHVybiBzYWx0c1xufVxuXG5jb25zdCBjcmVhdGVIYXNoID0gKGlkLCBzYWx0cywgYmFzZSkgPT4ge1xuICBjb25zdCBoYXNoID0gaWQudG9TdHJpbmcoYmFzZSlcbiAgbGV0IHBpZWNlcyA9IFsuLi5zYWx0cywgaGFzaF1cbiAgbGV0IGhhc2hTdHJpbmcgPSAnJ1xuICBkbyB7XG4gICAgbGV0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGllY2VzLmxlbmd0aClcbiAgICBoYXNoU3RyaW5nICs9IHBpZWNlc1tpbmRleF1cbiAgICBwaWVjZXMuc3BsaWNlKGluZGV4LCAxKVxuICB9IHdoaWxlIChwaWVjZXMubGVuZ3RoKVxuICByZXR1cm4gaGFzaFN0cmluZ1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgLyoqXG4gICAqIFRha2VzIGEgbnVtYmVyIGFuZCBhIHJhZGl4IGJhc2UsIG91dHB1dHMgYSBzYWx0ZWQgaGFzaFxuICAgKiBAcGFyYW0gIHtBcnJheX0gaWRzICAgbGlzdCBvZiBpZHMgdG8gaGFzaFxuICAgKiBAcGFyYW0ge051bWJlcn0gbiBudW1iZXIgb2Ygc2FsdHMgdG8gYWRkIHRvIHRoZSBoYXNoXG4gICAqIEBwYXJhbSAge051bWJlcn0gYmFzZSByYWRpeCBiYXNlLCAxNiB0aHJvdWdoIDM2IGFsbG93ZWRcbiAgICogQHJldHVybiB7T2JqZWN0fSAgICAgIGEgaGFzaCBvYmplY3QgY29udGFpbmluZyB0aGUgaGFzaGVzIGFzIHdlbGwgYXMgaW5mbyBuZWVkZWQgdG8gcmV2ZXJzZSB0aGVtXG4gICAqL1xuICBoYXNoIChpZHMsIG4sIGJhc2UpIHtcbiAgICBpZHMgPSBpZHMgfHwgW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCldXG4gICAgbiA9IG4gfHwgMlxuICAgIGJhc2UgPSBiYXNlIHx8IDM2XG5cbiAgICBpZiAoIWlkcy5zcGxpY2UpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBpZHMgYXJndW1lbnQgc2hvdWxkIGJlIGFuIGFycmF5IG9mIG51bWJlcnMnKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIG4gIT09ICdudW1iZXInIHx8IG4gPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgbnVtYmVyIG9mIHNhbHRzIHNob3VsZCBiZSBhIHBvc2l0aXZlIGludGVnZXInKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIGJhc2UgIT09ICdudW1iZXInIHx8IGJhc2UgPCAxNiB8fCBiYXNlID4gMzYpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBiYXNlIHNob3VsZCBiZSBhIG51bWJlciBiZXR3ZWVuIDE2IGFuZCAzNicpXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHRoZSBzYWx0cy4gVGhpcyB3aWxsIGJlIHRoZSBzYW1lIGZvciBhbGwgaGFzaGVzXG4gICAgY29uc3Qgc2FsdHMgPSBjcmVhdGVTYWx0cyhuLCBiYXNlKVxuXG4gICAgLy8gQ29tYmluZSB0aGUgc2FsdHMgYW5kIHRoZSBhY3R1YWxcbiAgICBsZXQgaGFzaGVzID0gaWRzLm1hcCgoaWQpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWQgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBpZHMgeW91XFwncmUgaGFzaGluZyBzaG91bGQgb25seSBiZSBudW1iZXJzJylcbiAgICAgIH1cbiAgICAgIHJldHVybiBjcmVhdGVIYXNoKGlkLCBzYWx0cywgYmFzZSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkczogaWRzLFxuICAgICAgaGFzaGVzOiBoYXNoZXMsXG4gICAgICBzYWx0czogc2FsdHMsXG4gICAgICBiYXNlOiBiYXNlXG4gICAgfVxuICB9LFxuICAvKipcbiAgICogU2ltcGxpZmllZCBBUEkgdG8ganVzdCByZXR1cm4gYSBzaW5nbGUgdG9rZW4gdXNpbmcgZGVmYXVsdHNcbiAgICogQHJldHVybiB7U3RyaW5nfSBhIGhhc2hcbiAgICovXG4gIGhhc2hpc2ggKCkge1xuICAgIHJldHVybiBjcmVhdGVIYXNoKFxuICAgICAgW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCldLFxuICAgICAgY3JlYXRlU2FsdHMoMiwgMzYpLFxuICAgICAgMzZcbiAgICApXG4gIH0sXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgc3BlY2lmaWVkIG51bWJlciBvZiByYW5kb20gdG9rZW5zXG4gICAqIEBwYXJhbSAge051bWJlcn0gbnVtICBudW1iZXIgb2YgdG9rZW5zIHRvIGNyZWF0ZVxuICAgKiBAcGFyYW0gIHtOdW1iZXJ9IG4gICAgbnVtYmVyIG9mIHNhbHRzIHRvIGFkZCB0byBlYWNoIGhhc2hcbiAgICogQHBhcmFtICB7TnVtYmVyfSBiYXNlIHJhZGl4IGJhc2UsIDE2IHRocm91Z2ggMzYgYWxsb3dlZFxuICAgKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgYSBoYXNoIG9iamVjdCBjb250YWluaW5nIHRoZSBoYXNoZXMgYXMgd2VsbCBhcyBpbmZvIG5lZWRlZCB0byByZXZlcnNlIHRoZW1cbiAgICovXG4gIGJ1bmNoIChudW0sIG4sIGJhc2UpIHtcbiAgICBudW0gPSBudW0gfHwgMVxuICAgIG4gPSBuIHx8IDJcbiAgICBiYXNlID0gYmFzZSB8fCAzNlxuXG4gICAgaWYgKHR5cGVvZiBudW0gIT09ICdudW1iZXInKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgbnVtIHNob3VsZCBiZSBhIG51bWJlcicpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgbiAhPT0gJ251bWJlcicgfHwgbiA8IDApIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBudW1iZXIgb2Ygc2FsdHMgc2hvdWxkIGJlIGEgcG9zaXRpdmUgaW50ZWdlcicpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgYmFzZSAhPT0gJ251bWJlcicgfHwgYmFzZSA8IDE2IHx8IGJhc2UgPiAzNikge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIGJhc2Ugc2hvdWxkIGJlIGEgbnVtYmVyIGJldHdlZW4gMTYgYW5kIDM2JylcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdGhlIGlkc1xuICAgIGxldCBpZHMgPSBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtOyBpKyspIHtcbiAgICAgIGlkcy5wdXNoKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIE1hdGgucG93KDEwLCBudW0udG9TdHJpbmcoMTApLmxlbmd0aCArIDIpKSlcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdGhlIHNhbHRzLiBUaGlzIHdpbGwgYmUgdGhlIHNhbWUgZm9yIGFsbCBoYXNoZXNcbiAgICBjb25zdCBzYWx0cyA9IGNyZWF0ZVNhbHRzKG4sIGJhc2UpXG5cbiAgICAvLyBDb21iaW5lIHRoZSBzYWx0cyBhbmQgdGhlIGFjdHVhbFxuICAgIGxldCBoYXNoZXMgPSBpZHMubWFwKChpZCkgPT4ge1xuICAgICAgcmV0dXJuIGNyZWF0ZUhhc2goaWQsIHNhbHRzLCBiYXNlKVxuICAgIH0pXG5cbiAgICByZXR1cm4ge1xuICAgICAgaWRzOiBpZHMsXG4gICAgICBoYXNoZXM6IGhhc2hlcyxcbiAgICAgIHNhbHRzOiBzYWx0cyxcbiAgICAgIGJhc2U6IGJhc2VcbiAgICB9XG4gIH0sXG4gIC8qKlxuICAgKiBUYWtlcyBhIHN0cmluZyBhbmQgbmVjZXNzYXJ5IGNvbXBvbmVudHMgdG8gcmV2ZXJzZSBiYWNrIHRvIHRoZSBvcmlnaW5hbCBudW1iZXJcbiAgICogQHBhcmFtICB7QXJyYXl9IGhhc2hlcyAgIGxpc3Qgb2YgaGFzaGVzIHRvIHJldmVyc2VcbiAgICogQHBhcmFtICB7QXJyYXl9IHNhbHRzICBsaXN0IG9mIHNhbHRzIGFwcGxpZWQgdG8gdGhlIGxpc3QgKHByb3ZpZGVkIGZyb20gYGhhc2hgKVxuICAgKiBAcGFyYW0gIHtiYXNlfSBiYXNlICAgICByYWRpeCBiYXNlLCAxNiB0aHJvdWdoIDM2IGFsbG93ZWRcbiAgICogQHJldHVybiB7QXJyYXl9ICAgICAgICAgIGxpc3Qgb2YgcmV2ZXJzZWQgaGFzaGVzXG4gICAqL1xuICByZXZlcnNlIChoYXNoZXMsIHNhbHRzLCBiYXNlKSB7XG4gICAgYmFzZSA9IGJhc2UgfHwgMzZcblxuICAgIGlmICghaGFzaGVzLnNwbGljZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIGhhc2hlcyBhcmd1bWVudCBzaG91bGQgYmUgYW4gYXJyYXkgb2YgaGFzaGVzIHByb3ZpZGVkIGJ5IHRoZSBoYXNoIG1ldGhvZCcpXG4gICAgfVxuICAgIGlmICghc2FsdHMuc3BsaWNlKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgc2FsdHMgYXJndW1lbnQgc2hvdWxkIGJlIGFuIGFycmF5IG9mIHNhbHQgc3RyaW5ncyBwcm92aWRlZCBieSB0aGUgaGFzaCBtZXRob2QnKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIGJhc2UgIT09ICdudW1iZXInIHx8IGJhc2UgPCAxNiB8fCBiYXNlID4gMzYpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBiYXNlIHNob3VsZCBiZSBhIG51bWJlciBiZXR3ZWVuIDE2IGFuZCAzNicpXG4gICAgfVxuICAgIGNvbnN0IHJlID0gbmV3IFJlZ0V4cChzYWx0cy5qb2luKCd8JyksICdnJylcblxuICAgIGxldCByZXZlcnNlZCA9IGhhc2hlcy5tYXAoKGhhc2gpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaGFzaCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhlIGhhc2hlcyB5b3VcXCdyZSByZXZlcnNpbmcgc2hvdWxkIG9ubHkgYmUgc3RyaW5ncycpXG4gICAgICB9XG4gICAgICBsZXQgc3RyaXBwZWQgPSBoYXNoLnJlcGxhY2UocmUsICcnKVxuICAgICAgcmV0dXJuIHBhcnNlSW50KHN0cmlwcGVkLCBiYXNlKVxuICAgIH0pXG5cbiAgICByZXR1cm4gcmV2ZXJzZWRcbiAgfVxufVxuIl19"}